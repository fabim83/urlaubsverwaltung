<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Urlaubsverwaltung</title>
    <link rel="stylesheet" href="/css/bootstrap.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fullcalendar.css" />
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="/js/fullcalendar/moment.min.js"></script>
    <script src="/js/fullcalendar/fullcalendar.js"></script>
    <script src="/js/fullcalendar/de.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/ajax.js"></script>
    <script>
      $(function(){
        $('#calendar-uebersicht-mitarbeiter').fullCalendar({
          locale: 'de',
          themeSystem: 'bootstrap3',
          header: {
            left: 'title',
            center: '',
            right: 'prev,next'
          }
        }).on('click', '.fc-prev-button,.fc-next-button', function(){
          var abteilung = $('#abteilung-uebersicht').val();

          if(abteilung){
            getKalendereintraegeZuAbteilung(abteilung);
          }
        });

        $('#von_datum').on('change', function () {
            if ($('#von_datum').val() == $('#bis_datum').val()) {
                $('#divHalberTag').show();
            } else {
                $('#divHalberTag').hide()
            }
        });

        $('#bis_datum').on('change', function () {
            if ($('#von_datum').val() == $('#bis_datum').val()) {
                $('#divHalberTag').show();
            } else {
                $('#divHalberTag').hide()
            }
        });

        $('#abteilung-uebersicht').on('change', function(){
          $('#calendar-uebersicht-mitarbeiter').fullCalendar('removeEvents');
          var abteilung = $('#abteilung-uebersicht').val();

          if(abteilung){
            getKalendereintraegeZuAbteilung(abteilung);
          }
        });

        setAnzahlOffeneMeldungen();
        getUebersicht();
        getOffeneMeldungen();
        getAbteilungen();
      });
    </script>
</head>
<body>
    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            {{#if user}}
              <li role="presentation"><a href="/">Home</a></li>
              <li role="presentation"><a href="/users/logout">Logout</a></li>
            {{else}}
              <li role="presentation"><a href="/users/login">Login</a></li>
              <li role="presentation"><a href="/users/register">Registrieren</a></li>
            {{/if}}
          </ul>
        </nav>
        <h3 class="text-muted">Urlaubsverwaltung</h3>
      </div>

      <div class="row marketing">
        <div class="col-lg-12">
            {{#if success_msg}}
              <div class="alert alert-success">{{success_msg}}</div>
            {{/if}}
            {{#if error_msg}}
              <div class="alert alert-danger">{{error_msg}}</div>
            {{/if}}
            {{#if error}}
              <div class="alert alert-danger">{{error}}</div>
            {{/if}}

            {{{body}}}
        </div>
      </div>
      <footer class="footer">
        <p>&copy; 2018 Urlaubsverwaltung</p>
      </footer>
    </div>
</body>
</html>